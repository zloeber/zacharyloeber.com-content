<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code,cloud,Azure,AWS,Kubernetes,Docker">
        <meta name="generator" content="Hugo 0.68.3" />
        <title> Skype For Business: Planning for Voice – Part 3 | Zachary Loeber</title>
        <meta name="description" content="Skype For Business: Planning for Voice – Part 3 - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="Skype For Business: Planning for Voice – Part 3">
        <meta itemprop="description" content="Skype For Business: Planning for Voice – Part 3 - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="Skype For Business: Planning for Voice – Part 3">
        <meta property="og:description" content="Skype For Business: Planning for Voice – Part 3 - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="https://zacharyloeber.com/blog/2015/09/12/skype-for-business-planning-for-voice-part-3/">
        <meta property="og:site_name" content="Zachary Loeber">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	
	  <link href="/blog/2015/09/12/skype-for-business-planning-for-voice-part-3/" rel="alternate" type="application/rss+xml" title="Zachary Loeber" />
	  <link href="/blog/2015/09/12/skype-for-business-planning-for-voice-part-3/" rel="feed" type="application/rss+xml" title="Zachary Loeber" />
	

        
        
        
        
        <link rel="stylesheet" href="/sass/combined.min.5f50be91a665634f9dfed5900bc388393fc430e3369d58e73b8375457a6df832.css">

        

        
            
                <link rel="stylesheet" href="https://zacharyloeber.com/css/mermaid.css">
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="/" target="">Home</a></li>
                
            
                
                    <li><a href="https://zacharyloeber.com/page/about-me/">About Me</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Zachary Loeber</a></h3>
            
                <span class="subtitle">I eat complexity and am never without a meal.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://zacharyloeber.com/blog/2015/09/12/skype-for-business-planning-for-voice-part-3/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://zacharyloeber.com/blog/2015/09/12/skype-for-business-planning-for-voice-part-3/">Skype For Business: Planning for Voice – Part 3</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2015-09-12</span>
            
        

        
            <span class="readingTime">11 min read</span>
        

        
            <span class="categories">
                
                    <a href="/categories/lync">Lync</a>
                
                    <a href="/categories/microsoft">Microsoft</a>
                
                    <a href="/categories/skype-for-business">Skype For Business</a>
                
                    <a href="/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>If you have been following along this series you already know the importance of getting a recent PSTN provider bill and performing an onsite visit. Next we will go into more depth on how the site PSTN is configured with your PBX at a site. There is lots of ground to cover so lets dive right in!</p>
<h1 id="pstn-configuration">PSTN Configuration</h1>
<p>There are all kinds of wonky telephony configurations out there. It is your job to figure out your own special kind of wonkiness ahead of time so you can plan for your PBX replacement accordingly. Understanding what you currently have goes beyond knowing how many T1s you have running to the building. You need to know channel selection methodologies, if selective routing is being performed (ie. long distance going out one T1 and local calling out another), and more.</p>
<p>Having replaced multiple phone systems I’ve come up with a questionnaire that should be filled out on a per site basis that covers a wide range of configuration options and can be used as a good starting point. I like to send this questionnaire out to each site admin ahead of time to see what people think they have. To be fair, usually only the most fastidious of site administrators are able to fully get this form filled out though. But occasionally some site administrators are able to respond with some measure of accuracy so that’s good! Even then, I find that it is extremely important to validate what has been entered with an onsite discovery visit to confirm everything first hand (as discussed in the prior article).</p>
<p>The questionnaire is broken down into multiple worksheets. It is expected that more worksheets will be added as required (or ancillary documentation is provided) in several areas.</p>
<h2 id="questionnaire-8211-general">Questionnaire – General</h2>
<p>This section contains general information about the site that is essential to know. This includes known local area codes, the primary site contact, full address, main number, and if there are any known unique phone requirements. That last question is really to get whomever is filling out the form to start thinking ahead about their environment. More information is better at this point.</p>
<p><a href="wp-content/uploads/2015/09/Site-PSTN-Conversion-Questionnaire-General.jpg"><!-- raw HTML omitted --></a></p>
<h2 id="questionnaire-8211-pbx">Questionnaire – PBX</h2>
<p>This worksheet is really just a place to remind people that you need access to the current PBX. Any diagrams, worksheets, directories, or nuances to the system should be noted here if possible.</p>
<p><a href="wp-content/uploads/2015/09/Site-PSTN-Conversion-Questionnaire-PBX-1.jpg"><!-- raw HTML omitted --></a></p>
<blockquote>
<p><strong>Tip:</strong> Do not assume that every T1 or ISDN line you see is something that is connected to a provider! I narrowly prevented a client from purchasing a 4x ISDN card for a new gateway device (which is not cheap) because there were 4 ISDN lines that were actually just connected between the PBX and the voicemail server. Part of this PBX worksheet explicitly splits out the voicemail server information as a mild reminder of the fact that these systems are often not handled directly by the PBX.</p>
</blockquote>
<h2 id="questionnaire-8211-dids">Questionnaire – DIDs</h2>
<p>This is where things start to get a bit cumbersome. Essentially any known information on the current DID assignments would be great to have early on. Many times what is provided here is wildly outdated but something is better than nothing. With access to the current PBX and some fortitude maybe you can find a way to export this information yourself to validate. In the worst case scenario you end up going around the office and pulling an inventory of active users and the numbers they believe they are assigned.</p>
<p><a href="wp-content/uploads/2015/09/Site-PSTN-Conversion-Questionnaire-DIDs.jpg"><!-- raw HTML omitted --></a></p>
<blockquote>
<p>**Tip: **You do need the DID assignments on a per user basis. More so you will want the ranges of numbers that the site actually owns. It is vital to get this list from the provider (though it will certainly take some finagling to procure). Also, don’t assume that a list of extensions and users represents anything logical. They may just be random internal only extensions behind any number of public numbers!</p>
</blockquote>
<h2 id="questionnaire-8211-pstn-configuration">Questionnaire – PSTN Configuration</h2>
<p>This is the meat and potatoes of the workbook. Pretty much everything any implementation engineer (from Sonus/Audiocodes) might need to deploy a new PSTN gateway should be covered in this worksheet. There are areas for the following:</p>
<ul>
<li>PSTN Provider Information</li>
<li>T1/E1 Lines</li>
<li>ISDN Lines</li>
<li>Analog Lines</li>
<li>SIP Trunks</li>
<li>Media Settings</li>
</ul>
<p>The PSTN provider information area is basic stuff so lets skip to the T1 (US) or E1 (EU) section.</p>
<h3 id="t1e1-lines">T1/E1 Lines</h3>
<p><a href="wp-content/uploads/2015/09/Site-PSTN-Conversion-Questionnaire-PSTN-1.jpg"><!-- raw HTML omitted --></a></p>
<p>Aside from a basic count of lines there is some pretty specific information being requested. The most important for a migration to new equipment would be the framing method and protocol type. If you are lucky you can infer this information from the current PBX configuration or the media gateways it uses (For example, Cisco Call Manager configuration information can be found in the GUI or directly in the routers it pushes configs down to). If in doubt you can connect with the provider and they should be able to confirm what they expect these to be set to.</p>
<blockquote>
<p><strong>Tip</strong>: If you are not entirely certain what the framing and protocol types on a T1 line is then try ESF with CRC6 (extended super frame) and ISDN. It is not always correct but it is quite common. You know you ‘might’ be using the correct settings if the T1 line goes yellow/orange for a few seconds then goes green. If that does not work I’d start cycling trough the framing types first to try and get the right combination.</p>
</blockquote>
<p>I also leave just one section for T1/E1 line information. Ideally you will validate each line for as much information as you can possibly gather. This includes channels used, the channel selection method, circuit IDs, and purpose where possible. If 1 out of 3 T1’s is used for a direct connection to an Australian office then that is extremely important to know after all!</p>
<blockquote>
<p><strong>Tip:</strong> Not listed in the questionnaire is the T1 channel selection mode. This would be the method that the provider chooses to select channels on the T1 line for your inbound calls. This is almost certainly going to be cyclic ascending. So the provider will start the first inbound call on channel 0, then if that call is still active the next call will be sent down channel 1, the next on 2, and so on. You, on the other hand, will not want to waste time sending your outbound calls out these channels but instead will use a cyclic descending method for channel selection (starting at the topmost channel and working your way down).</p>
<p>So, if you will be putting a gateway in between your old PBX and the T1s to split out calls to Skype For Business then your T1 trunks will be set to select channels cyclic descending on the connection to the T1 to the provider and cyclic ascending on the connection back to the old PBX.</p>
</blockquote>
<p>Another item in the list is how many digits of a phone number the provider will send to the PBX and what the provider expects to get from the PBX in your outbound calls. On T1s I’ve seen as few as 3 digits being sent on inbound calls! This is not the norm though. Usually there are between 4 and 10 digits. Again, the provider can confirm this. Otherwise you will be reading through syslogs on your new gateway the night of the site cutover and having to figure it out on the fly.</p>
<blockquote>
<p><strong>What about PRI’s?</strong></p>
<p>Although I don’t explicitly list PRI circuits in the questionnaire you can assume that for this exercise PRI’s and T1’s are one and the same. PRI and BRI are really <a href="https://en.wikipedia.org/wiki/Integrated_Services_Digital_Network#Sample_call">different ISDN interfaces</a>. PRIs are often bundled into <a href="https://en.wikipedia.org/wiki/T-carrier">T-carrier</a> or <a href="https://en.wikipedia.org/wiki/E-carrier">E-carrier</a> lines and so you might often hear people say that they have a ‘PRI’ and not a T1. Just nod and agree with them as they generally have the right idea just the wrong wording. This may also explain why you may see a bill that lists 24x ISDN lines instead of a single T1 line.</p>
<p>As always, I’m oversimplifying this terminology nuance. I recommend reading through the wikipedia links to get a more comprehensive understanding of all this telco jargon instead of just taking my word on it.</p>
</blockquote>
<h3 id="isdn-lines">ISDN Lines</h3>
<p>I had to add this section in the questionnaire as technically you may have a site with ISDN lines coming in from your carrier. In reality, if you do have this kind of technology being used to route voice calls to the PSTN then you really need to look at migrating whatever numbers you have tied to the ISDN lines to something else. In every case I’ve experienced ISDN lines being terminated at an office they were found to be unneeded and were summarily replaced with VoIP devices. If you do have these lines they may be dedicated for conference rooms or as a means of communication between different components of a PBX.</p>
<p><a href="wp-content/uploads/2015/09/Site-PSTN-Conversion-Questionnaire-PSTN-2.jpg"><!-- raw HTML omitted --></a></p>
<h3 id="analog-lines">Analog Lines</h3>
<p>Analog lines will be found in your office in two varieties. One kind is directly from your carrier to a punchdown block and, from there, run directly to your PBX or throughout the office to individual jacks. A great example of this is found on most security systems that phone home or third party services when alarms are tripped (such as ADT or others). These are almost always going to be on separate analog lines run from another (or even the same) carriers. Good news is that you really aren’t that interested in anything not being handled by the legacy PBX so you can usually ignore these isolated systems in your assessments.</p>
<p>The other kind of analog lines you will see are those that originate from your PBX, an analog gateway connected to the PBX, or an ATA device which is connected to the PBX. These are used as a way to connect with legacy devices like modems, intercoms, or door systems.</p>
<blockquote>
<p><strong>Tip:</strong> You will hear ATA and ‘Analog Gateway’ used interchangeably. This is because they are essentially the same devices but at different port densities. Analog gateways are usually above 4 ports with common sizes being 8, 16, and 24 analog lines. Analog gateways under 24 lines usually have individual RJ-9 2-wire telephone ports. At 24 lines you will often see <a href="https://en.wikipedia.org/wiki/Telco_cable">50-pin Amphenol connectors</a> being used instead. ATA devices are most commonly found behind fax machines or all-in-one fax capable printers where you may not want to run an analog line.</p>
</blockquote>
<h3 id="sip-trunks--media-settings">SIP Trunks &amp; Media Settings</h3>
<p>It is entirely possible that you might be integrating with an already existing SIP trunk from a carrier instead of some dusty old T1/E1 lines. If so then you still need to know how to interface with them. Likely there will already be some good carrier specific guides to be found for integration with your chosen vendor’s gateway. It should be noted that if you are already using a Session Border Controller (SBC) to integrate with a SIP provider then there is a good chance you can use it to integrate with Skype For Business as well!</p>
<p><a href="/wp-content/uploads/2015/09/Site-PSTN-Conversion-Questionnaire-PSTN-3.jpg"><!-- raw HTML omitted --></a></p>
<p>I included the media settings part of the questionnaire as I’ve seen these settings be requested from implementation engineers. For a Lync/Skype deployment you will almost certainly be choosing G.711 (u-law or a-law). G.711 is sufficient for analog level narrow-band crappy quality voice everyone is used to over the PSTN. <a href="https://technet.microsoft.com/en-us/library/Gg399005%28v=OCS.15%29.aspx?f=255&amp;MSPPError=-2147217396">Lync trunks only support G.711 as well</a>.</p>
<blockquote>
<p><strong>Tip: Hidden Costs</strong></p>
<p>If you can do G.729 to the provider go for it as it will allow you to cram more active calls in the same bandwidth. G.722 starts to sound much better but there are hidden costs involved. As Lync/Skype will only support G.711 you will likely have to ‘transcode’ the calls on the SBC back to your mediation servers (convert from one codec to another). This transcoding is almost always an extra license on the device and may even require extra processing power depending on your call volumes.</p>
<p>SIP licensing is also almost always tacked on separately to gateway purchases. Audiocodes (and most gateway vendors) will give you the T1/E1 to SIP call routing for free. The moment you start performing SIP to SIP routing of calls an additional license will need to be purchased. This is very important to know up front when designing call routing between different systems!</p>
<p>Usually SIP licensing is sold in counts representing total number of concurrent SIP connections. In a distributed environment this licensing can be difficult to manage. I’d work with your vendor to discuss some new pricing models and technologies that I’ve heard wind of that allow you to float licenses between devices in a single pool.</p>
</blockquote>
<p> </p>
<h2 id="conclusion">Conclusion</h2>
<p>I think that is more than enough information for today. Hopefully this is enough to jump-start your discovery process. I do not profess to be an industry expert on the telco side so I welcome corrections to anything in this article. As always I’ve uploaded this workbook with the rest of the resources from this series of articles to <a href="https://github.com/zloeber/Unified-Communications">a github repository for your convenience</a>.</p>
    
</div>

    
<div class="footer">
    

        
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                <a href="/tags/lync-2013">Lync 2013</a>
                
                <a href="/tags/lync-server-2013">Lync Server 2013</a>
                
                <a href="/tags/lync-voice">Lync Voice</a>
                
                <a href="/tags/microsoft">Microsoft</a>
                
                <a href="/tags/psc">PSC</a>
                
                <a href="/tags/skype-for-business">Skype For Business</a>
                
                <a href="/tags/sysadmin">Sysadmin</a>
                
                <a href="/tags/system-administration">System Administration</a>
                
            </div>
        </div>
        

        
        


<style>
    #share-buttons {
        display: inline-block;
        vertical-align: middle;
    }

    #share-buttons:after {
        content: "";
        display: block;
        clear: both;
    }

    #share-buttons>div {
        position: relative;
        text-align: left;
        height: 36px;
        width: 32px;
        float: left;
        text-align: center;
    }

    #share-buttons>div>svg {
        height: 16px;
        fill: #d5d5d5;
        margin-top: 10px;
    }

    #share-buttons>div:hover {
        cursor: pointer;
    }

    #share-buttons>div.facebook:hover>svg {
        fill: #3B5998;
    }

    #share-buttons>div.twitter:hover>svg {
        fill: #55ACEE;
    }

    #share-buttons>div.linkedin:hover>svg {
        fill: #0077b5;
    }

    #share-buttons>div.facebook>svg {
        height: 18px;
        margin-top: 9px;
    }

    #share-buttons>div.twitter>svg {
        height: 20px;
        margin-top: 8px;
    }

    #share-buttons>div.linkedin>svg {
        height: 19px;
        margin-top: 7px;
    }
</style>
<div id="share-buttons">
    <div class="facebook" title="Share this on Facebook"
        onclick="window.open('https://www.facebook.com/share.php?u=https:\/\/zacharyloeber.com\/\/blog\/2015\/09\/12\/skype-for-business-planning-for-voice-part-3\/');">
        <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M1343 12v264h-157q-86 0-116 36t-30 108v189h293l-39 296h-254v759h-306v-759h-255v-296h255v-218q0-186 104-288.5t277-102.5q147 0 228 12z" />
        </svg>
    </div>
    <div class="twitter" title="Share this on Twitter"
        onclick="window.open('https://twitter.com/intent/tweet?text=https:\/\/zacharyloeber.com\/\/blog\/2015\/09\/12\/skype-for-business-planning-for-voice-part-3\/');">
        <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M1684 408q-67 98-162 167 1 14 1 42 0 130-38 259.5t-115.5 248.5-184.5 210.5-258 146-323 54.5q-271 0-496-145 35 4 78 4 225 0 401-138-105-2-188-64.5t-114-159.5q33 5 61 5 43 0 85-11-112-23-185.5-111.5t-73.5-205.5v-4q68 38 146 41-66-44-105-115t-39-154q0-88 44-163 121 149 294.5 238.5t371.5 99.5q-8-38-8-74 0-134 94.5-228.5t228.5-94.5q140 0 236 102 109-21 205-78-37 115-142 178 93-10 186-50z" />
        </svg>
    </div>
    <div class="linkedin" title="Share this on Linkedin"
        onclick="window.open('https://www.linkedin.com/shareArticle?mini=true&url=https:\/\/zacharyloeber.com\/\/blog\/2015\/09\/12\/skype-for-business-planning-for-voice-part-3\/&title=&summary=&source=');">
        <svg viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg">
            <path
                d="M477 625v991h-330v-991h330zm21-306q1 73-50.5 122t-135.5 49h-2q-82 0-132-49t-50-122q0-74 51.5-122.5t134.5-48.5 133 48.5 51 122.5zm1166 729v568h-329v-530q0-105-40.5-164.5t-126.5-59.5q-63 0-105.5 34.5t-63.5 85.5q-11 30-11 81v553h-329q2-399 2-647t-1-296l-1-48h329v144h-2q20-32 41-56t56.5-52 87-43.5 114.5-15.5q171 0 275 113.5t104 332.5z" />
        </svg>
    </div>
</div>
    </div>
</article>

        
    </div>

    
        
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="https://zacharyloeber.com/2020/12/2021-it-industry-predictions/">2021 - IT Industry Predictions</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/2020/07/the-declarative-mindset/">The Declarative Mindset</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/2020/05/aws-testing-with-localstack-on-kubernetes/">Aws Testing With Localstack on Kubernetes</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="/categories/networking">Networking (52)</a>
                    </li>
                
                    <li>
                        <a href="/categories/exchange">Exchange (38)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
                    <a href="https://www.linkedin.com/in/zloeber/" target="_blank"><i class="fa fa-linkedin"></i></a>
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2021
                
                by Zachary Loeber
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
                <script src="https://zacharyloeber.com/js/mermaid.js" type="application/javascript"></script>
            
        

        


    </body>
</html>
