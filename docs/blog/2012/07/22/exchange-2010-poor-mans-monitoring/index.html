<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code">
        <meta name="generator" content="Hugo 0.59.1" />
        <title> Exchange 2010: Poor Man’s Monitoring | Zachary Loeber</title>
        <meta name="description" content="Exchange 2010: Poor Man’s Monitoring - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="Exchange 2010: Poor Man’s Monitoring">
        <meta itemprop="description" content="Exchange 2010: Poor Man’s Monitoring - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="Exchange 2010: Poor Man’s Monitoring">
        <meta property="og:description" content="Exchange 2010: Poor Man’s Monitoring - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="https://.zacharyloeber.com/blog/2012/07/22/exchange-2010-poor-mans-monitoring/">
        <meta property="og:site_name" content="Zachary Loeber">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://.zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://.zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	
	  <link href="/blog/2012/07/22/exchange-2010-poor-mans-monitoring/" rel="alternate" type="application/rss+xml" title="Zachary Loeber" />
	  <link href="/blog/2012/07/22/exchange-2010-poor-mans-monitoring/" rel="feed" type="application/rss+xml" title="Zachary Loeber" />
	

        
        
        
        
        <link rel="stylesheet" href="/sass/combined.min.5f50be91a665634f9dfed5900bc388393fc430e3369d58e73b8375457a6df832.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="/" target="">Home</a></li>
                
            
                
                    <li><a href="https://.zacharyloeber.com/page/about/">About</a></li>
                
            
                
                    <li><a href="https://.zacharyloeber.com/page/about-me/">About Me</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Zachary Loeber</a></h3>
            
                <span class="subtitle">The personal website of Zachary Loeber.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://.zacharyloeber.com/blog/2012/07/22/exchange-2010-poor-mans-monitoring/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://.zacharyloeber.com/blog/2012/07/22/exchange-2010-poor-mans-monitoring/">Exchange 2010: Poor Man’s Monitoring</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2012-07-22</span>
            
        

        
            <span class="readingTime">2 min read</span>
        

        
            <span class="categories">
                
                    <a href="/categories/exchange">Exchange</a>
                
                    <a href="/categories/exchange-2010">Exchange 2010</a>
                
                    <a href="/categories/microsoft">Microsoft</a>
                
                    <a href="/categories/powershell">Powershell</a>
                
                    <a href="/categories/storage">Storage</a>
                
                    <a href="/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>I quietly released a new script into the wild the other day, Troubleshoot-MailboxServer.ps1. This script is meant for monitoring, fixing, and reporting on Exchange 2010 database servers. It pretty much just wraps around and reports on troubleshooting scripts found in %ExchangeInstallPath%Scripts. I also set it so you can have an email sent including warning/error color coded report upon completion.</p>

<p>Optionally, an overall system health overview can be sent following any warnings/errors which are generated from the scripts. This last report is purely optional and is actually just another person’s script which I rolled into Troubleshoot-MailboxServer.ps1. This report has some external requirements though. <a href="http://www.simple-talk.com/sysadmin/powershell/building-a-daily-systems-report-email-with-powershell/">The original author’s release of the script can be read here</a>. The external requirements are <a href="http://www.microsoft.com/download/en/details.aspx?id=14422">MS Chart Controls for .Net 3.5</a>. So if you are not wanting to install these requirements on your Exchange server then make certain to set $SendSystemReport to $false.</p>

<p>The scripts which Troubleshoot-MailboxServer.ps1 calls are as follows:</p>

<ul>
<li>Troubleshoot-CI.ps1 (I cannot seem to find the ms technet article for this one)</li>
<li><a href="http://technet.microsoft.com/en-us/library/ff798271">Troubleshoot-DatabaseLatency.ps1</a></li>
<li><a href="http://technet.microsoft.com/en-us/library/ff477617.aspx">Troubleshoot-DatabaseSpace.ps1</a></li>
</ul>

<p>More information about the <a href="http://blogs.technet.com/b/exchange/archive/2011/01/18/3411844.aspx">Exchange 2010 Troubleshooters can be found here.</a></p>

<p>For good measure I tossed in the option to redistribute your DAG(s) with <a href="http://technet.microsoft.com/library/dd335158%28v=EXCHG.141%29">RedistributeActiveDatabases.ps1</a>.</p>

<p>Be cautioned that, although this script does have a “testing” mode, it does not prevent the troubleshooter scripts from disabling provisioning of mailboxes to databases as that feature is not available as part of the troubleshooter scripts. Should you find that databases have become unprovisionable and you want the ability to provision to them again you need to run the following from an Exchange 2010 management shell:</p>

<pre>Set-MailboxDatabase &lt;database name&gt; -IsExcludedFromProvisioning:$false</pre>

<p>In Exchange 2010 SP1 the CheckDatabaseRedundancy.ps1 script is included and scheduled to automatically run. Apparently they used ManageScheduledTask.ps1 (which is also new to SP1) to automate scheduling the task. As when you use ManageScheduledTask.ps1 the description given to any new scheduled task you create with it reads that it is a task for checking database redundancy J. Regardless, you can use that script to schedule Exchange-DatabaseMonitoring.ps1.</p>

<pre>cd $exscripts</pre>

<pre>.\ManageScheduledTask.ps1 -Install -ServerName &lt;Your Server&gt; -PsScriptPath C:\Scripts\Troubleshoot-MailboxServer.ps1 -TaskName "Troubleshoot Exchange 2010 Mailbox Servers"</pre>

<p>(Note: this adds the scheduled task as a generic task, you will still need to go into scheduled tasks  and set a schedule for it to run and add change the description).</p>

<p>Download the script: <a href="/wp-content/uploads/2012/07/Troubleshoot-MailboxServer.ps1">Troubleshoot-MailboxServer.ps1</a></p>

<p>or</p>

<p class="MsoNoSpacing">
  <a title="Troubleshoot-MailboxDatabase on Technet script center" href="http://gallery.technet.microsoft.com/scriptcenter/Troubleshoot-Exchange-2010-aecdc23f">From here</a>
</p>
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/exchange-2010">Exchange 2010</a>
                
                    <a href="/tags/microsoft">Microsoft</a>
                
                    <a href="/tags/monitoring">Monitoring</a>
                
                    <a href="/tags/powershell">Powershell</a>
                
                    <a href="/tags/system-administration">System Administration</a>
                
            </div>
        </div>
    

    
</div>

</article>

        
    </div>

    
        
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="https://.zacharyloeber.com/blog/2018/12/10/devops-tool-of-the-day-syncthing/">Devops: Tool of the day – Syncthing</a>
                    </li>
                
                    <li>
                        <a href="https://.zacharyloeber.com/blog/2018/09/28/devops-automating-kubernetes-deployments/">DevOps – Automating Kubernetes Deployments</a>
                    </li>
                
                    <li>
                        <a href="https://.zacharyloeber.com/blog/2018/05/02/powershell-to-python-notes-from-the-field/">Powershell To Python Notes From The Field</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="/categories/networking">Networking (52)</a>
                    </li>
                
                    <li>
                        <a href="/categories/active-directory">Active directory (44)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2019
                
                by Zachary Loeber
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
