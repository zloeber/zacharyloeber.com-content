<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code">
        <meta name="generator" content="Hugo 0.53" />
        <title> PowerShell: PowerShellGet Helper Functions | Zachary Loeber</title>
        <meta name="description" content="PowerShell: PowerShellGet Helper Functions - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="PowerShell: PowerShellGet Helper Functions">
        <meta itemprop="description" content="PowerShell: PowerShellGet Helper Functions - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="PowerShell: PowerShellGet Helper Functions">
        <meta property="og:description" content="PowerShell: PowerShellGet Helper Functions - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="https://zacharyloeber.com/blog/2016/12/21/powershell-powershellget-helper-functions/">
        <meta property="og:site_name" content="Zachary Loeber">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	

        
        
        
        
        <link rel="stylesheet" href="/sass/combined.min.5f50be91a665634f9dfed5900bc388393fc430e3369d58e73b8375457a6df832.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="/" target="">Home</a></li>
                
            
                
                    <li><a href="/page/about/">About</a></li>
                
            
                
                    <li><a href="/page/about-me/">About Me</a></li>
                
            
                
                    <li><a href="https://github.com/zloeber" target="_blank">Github</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Zachary Loeber</a></h3>
            
                <span class="subtitle">The personal website of Zachary Loeber.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="/blog/2016/12/21/powershell-powershellget-helper-functions/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="/blog/2016/12/21/powershell-powershellget-helper-functions/">PowerShell: PowerShellGet Helper Functions</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2016-12-21</span>
            
        

        
            <span class="readingTime">3 min read</span>
        

        
            <span class="categories">
                
                    <a href="/categories/microsoft">Microsoft</a>
                
                    <a href="/categories/powershell">Powershell</a>
                
                    <a href="/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>With the PowerShell Gallery at your fingertips in PowerShell v5 you are able to find and install modules and scripts quickly. Here are a few helper functions you may want to add to your profile to help automate some of these tasks.</p>

<p>I&#8217;ve been using Install-Module, Find-Module, and the other nifty commands in PowerShellGet for a while now. A few tasks which I&#8217;ve found helpful have morphed into their own scripts that I run fairly often. These helper functions have been published for a while buried in one of my github repos but I figured they are worthy enough for their own quick post. I keep these in a path of one-off scripts that gets loaded into my user&#8217;s environmental path variable within my PowerShell profile.</p>

<h1 id="helper-1-upgrade-installedmodules-ps1">Helper 1: Upgrade-InstalledModules.ps1</h1>

<p>This simple script wraps around the Get-InstalledModule and Update-Module commands and attempts to upgrade modules installed on your system. Nothing fancy here.</p>

<pre class="lang:powershell decode:true">&lt;#
.SYNOPSIS
    A small wrapper for PowerShellGet to upgrade all installed modules and scripts.
.DESCRIPTION
    A small wrapper for PowerShellGet to upgrade all installed modules and scripts.
.PARAMETER WhatIf
    Show modules which would get upgraded.
.EXAMPLE
    Upgrade-InstalledModules.ps1

    Description
    -------------
    Updates modules installed via PowerShellGet.
.NOTES
       Author: Zachary Loeber
       
       Requires: Powershell 5.0

       Version History
       1.0.0 - Initial release
#&gt;
[CmdletBinding()]
Param (
    [Parameter(HelpMessage = 'Show modules which would get upgraded.')]
    [switch]$WhatIf
)

try {
    Import-Module PowerShellGet
}
catch {
    Write-Warning 'Unable to load PowerShellGet. This script only works with PowerShell 5 and greater.'
    return
}

$WhatIfParam = @{WhatIf=$WhatIf}

Get-InstalledModule | Update-Module -Force @WhatIfParam
#Get-InstalledScript | Update-Script @WhatIfParam</pre>

<h1 id="helper-2-remove-oldmodule-ps1">Helper 2: Remove-OldModule.ps1</h1>

<p>As you begin to use install-module you will start to collect older versions of modules without even realizing it. This helper script will check a module for all the versions that are installed and attempt to remove all but the newest version.  When you run this without any module name it will loop through all installed modules. If you are worried about what it might try to uninstall use the -WhatIf flag.</p>

<pre class="lang:powershell decode:true ">#Requires -Version 5

&lt;#
.SYNOPSIS
    A small wrapper for PowerShellGet to remove all older installed modules.
.DESCRIPTION
    A small wrapper for PowerShellGet to remove all older installed modules.
.PARAMETER ModuleName
    Name of a module to check and remove old versions of.
.EXAMPLE
    PS&gt; Remove-OldModules.ps1

    Removes old modules installed via PowerShellGet.

.EXAMPLE
    PS&gt; Remove-OldModules.ps1 -whatif

    Shows what old modules might be removed via PowerShellGet.

.NOTES
       Author: Zachary Loeber
       
       Requires: Powershell 5.0

       Version History
       1.0.0 - Initial release
#&gt;
[CmdletBinding( SupportsShouldProcess = $true )]
Param (
    [Parameter(HelpMessage = 'Name of a module to check and remove old versions of.')]
    [string]$ModuleName = '*'
)

try {
    Import-Module PowerShellGet
}
catch {
    Write-Warning 'Unable to load PowerShellGet. This script only works with PowerShell 5 and greater.'
    return
}
$WhatIfParam = @{}
$WhatIfParam.WhatIf = $WhatIf
Get-InstalledModule $ModuleName | Foreach-Object {
    $InstalledModules = get-module $_.Name -ListAvailable
    if ($InstalledModules.Count -gt 1) {
        $SortedModules = $InstalledModules | sort-object Version -Descending
        Write-Output "Multiple Module versions for the $($SortedModules[0].Name) module found. Highest version is: $($SortedModules[0].Version.ToString())"
        for ($index = 1; $index -lt $SortedModules.Count; $index++) {
            try {
                if ($pscmdlet.ShouldProcess( "$($SortedModules[$index].Name) - $($SortedModules[$index].Version)")) {
                    Write-Output "..Attempting to uninstall $($SortedModules[$index].Name) - Version $($SortedModules[$index].Version)"
                    Uninstall-Module -Name $SortedModules[$index].Name -MaximumVersion $SortedModules[$index].Version -ErrorAction Stop -Force
                }
            }
            catch {
                Write-Warning "Unable to remove module version $($SortedModules[$index].Version)"
            }
        }
    }
}</pre>

<p>And that is really it. Enjoy!</p>
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/microsoft">Microsoft</a>
                
                    <a href="/tags/powershell">Powershell</a>
                
                    <a href="/tags/powershell-script">Powershell Script</a>
                
                    <a href="/tags/system-administration">System Administration</a>
                
                    <a href="/tags/windows">Windows</a>
                
            </div>
        </div>
    

    
</div>

</article>

        
    </div>

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zacharyloeber-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="/blog/2018/12/10/devops-tool-of-the-day-syncthing/">Devops: Tool of the day – Syncthing</a>
                    </li>
                
                    <li>
                        <a href="/blog/2018/09/28/devops-automating-kubernetes-deployments/">DevOps – Automating Kubernetes Deployments</a>
                    </li>
                
                    <li>
                        <a href="/blog/2018/05/02/powershell-to-python-notes-from-the-field/">Powershell To Python Notes From The Field</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="/categories/networking">Networking (52)</a>
                    </li>
                
                    <li>
                        <a href="/categories/active-directory">Active directory (44)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2019
                
                by Zachary Loeber
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
