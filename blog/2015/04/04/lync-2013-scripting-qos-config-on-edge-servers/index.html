<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code">
        <meta name="generator" content="Hugo 0.53" />
        <title> Lync 2013: Scripting QoS Config on Edge Servers | Zachary Loeber</title>
        <meta name="description" content="Lync 2013: Scripting QoS Config on Edge Servers - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="Lync 2013: Scripting QoS Config on Edge Servers">
        <meta itemprop="description" content="Lync 2013: Scripting QoS Config on Edge Servers - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="Lync 2013: Scripting QoS Config on Edge Servers">
        <meta property="og:description" content="Lync 2013: Scripting QoS Config on Edge Servers - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="http://zacharyloeber.com/blog/2015/04/04/lync-2013-scripting-qos-config-on-edge-servers/">
        <meta property="og:site_name" content="Zachary Loeber">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="http://zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="http://zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	

        
        
        
        
        <link rel="stylesheet" href="/sass/combined.min.5aca3dc995ccd40fd537c60ccb5ce5882145ec5d4c4827c15f277667981cc0de.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="https://github.com/zloeber" target="_blank">Github</a></li>
                
            
                
                    <li><a href="/page/about/">About</a></li>
                
            
                
                    <li><a href="/page/about-me/">About Me</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Zachary Loeber</a></h3>
            
                <span class="subtitle">The personal website of Zachary Loeber.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="/blog/2015/04/04/lync-2013-scripting-qos-config-on-edge-servers/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="/blog/2015/04/04/lync-2013-scripting-qos-config-on-edge-servers/">Lync 2013: Scripting QoS Config on Edge Servers</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2015-04-04</span>
            
        

        
            <span class="readingTime">3 min read</span>
        

        
            <span class="categories">
                
                    <a href="/categories/lync">Lync</a>
                
                    <a href="/categories/microsoft">Microsoft</a>
                
                    <a href="/categories/powershell">Powershell</a>
                
                    <a href="/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>In many environments the Lync 2013 edge servers are configured in a standalone workgroup without any easy method for setting standard policies (such as GPOs). To make QoS configuration a bit less manual and error prone I&#8217;ve put together this script which can be run in an administrative powershell prompt. It will update the NLA setting (or create it if it doesn&#8217;t already exist), backup and prompt for removal any existing Qos settings, then import the registry settings for Audio, Video, and App QoS settings as defined in the script parameters.</p>

<h2 id="details">Details</h2>

<p>QoS settings in Windows are simply registry keys with some values underneath. All this script does behind the scenes is create a .reg file based on a template and imports it. The default settings are fairly standard but are also easy to change to suit your needs or environment. Although the current QoS settings are displayed and exported to a backup .reg file I still recommend caution when running this script in your production environment.</p>

<p>Here is the obligatory comment based help for the script:</p>

<pre class="lang:powershell decode:true">&lt;# 
.SYNOPSIS 
Sets Qos configuration on Lync edge servers quickly. 
.DESCRIPTION 
Sets Qos configuration on Lync edge servers quickly. This is meant to be run locally at each edge server. 
.PARAMETER AudioPortStart 
Audio Qos port start. Default value is 49152 
.PARAMETER AudioPortEnd 
Audio Qos port End. Default value is 57500 
.PARAMETER AudioDSCP 
Audio Qos DSCP value. Default value is 46 
.PARAMETER VideoPortStart 
Video Qos port start. Default value is 57501 
.PARAMETER VideoPortEnd 
Video Qos port start. Default value is 65535 
.PARAMETER VideoDSCP 
Video Qos DSCP value. Default value is 32  
.PARAMETER AppPortStart 
App Qos port start. Default value is 40803 
.PARAMETER AppPortEnd 
App Qos port start. Default value is 48837 
.PARAMETER AppDSCP 
App Qos DSCP value. Default value is 0 
.EXAMPLE 
PS &gt; Set-LyncEdgeQos 
 
Description 
----------- 
Sets the egde server Qos values to the defaults defined in the script parameters then displays them.  
 
The default values will look something like this when used: 
 
    Policy            : Lync App Sharing 
    Local Ports       : * 
    Local Port Begin  : NA 
    Local Port End    : NA 
    Local Port Count  : NA 
    Remote Ports      : 40803:48837 
    Remote Port Begin : 40803 
    Remote Port End   : 48837 
    Remote Port Count : 8034 
    DSCP Value        : 0 
 
    Policy            : Lync Audio 
    Local Ports       : * 
    Local Port Begin  : NA 
    Local Port End    : NA 
    Local Port Count  : NA 
    Remote Ports      : 49152:57500 
    Remote Port Begin : 49152 
    Remote Port End   : 57500 
    Remote Port Count : 8348 
    DSCP Value        : 46 
 
    Policy            : Lync Video 
    Local Ports       : * 
    Local Port Begin  : NA 
    Local Port End    : NA 
    Local Port Count  : NA 
    Remote Ports      : 57501:65535 
    Remote Port Begin : 57501 
    Remote Port End   : 65535 
    Remote Port Count : 8034 
    DSCP Value        : 32 
.NOTES 
Author: Zachary Loeber 
 
Requires: Powershell 3.0 
 
Version History 
1.0.0 - 03/31/2015 
- Initial release 
#&gt;</pre>

<p>As usual, the script has been uploaded to the <a href="https://gallery.technet.microsoft.com/Lync-2013-Set-Local-Server-724655df">Microsoft technet gallary</a> and <a href="https://github.com/zloeber/Powershell/blob/master/Lync/Set-LyncEdgeQos.ps1">my github repo</a>.</p>
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/lync">Lync</a>
                
                    <a href="/tags/lync-2013">Lync 2013</a>
                
                    <a href="/tags/lync-server-2013">Lync Server 2013</a>
                
                    <a href="/tags/lync-voice">Lync Voice</a>
                
                    <a href="/tags/microsoft">Microsoft</a>
                
                    <a href="/tags/powershell">Powershell</a>
                
                    <a href="/tags/psc">PSC</a>
                
                    <a href="/tags/windows">Windows</a>
                
            </div>
        </div>
    

    
</div>

</article>

        
    </div>

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zacharyloeber-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="/blog/2018/12/10/devops-tool-of-the-day-syncthing/">Devops: Tool of the day – Syncthing</a>
                    </li>
                
                    <li>
                        <a href="/blog/2018/09/28/devops-automating-kubernetes-deployments/">DevOps – Automating Kubernetes Deployments</a>
                    </li>
                
                    <li>
                        <a href="/blog/2018/05/02/powershell-to-python-notes-from-the-field/">Powershell To Python Notes From The Field</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="/categories/networking">Networking (52)</a>
                    </li>
                
                    <li>
                        <a href="/categories/active-directory">Active directory (44)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2019
                
                by Zachary Loeber
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
