<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta name=description content><meta name=keywords content><meta name=generator content="Hugo 0.53"><title>Exchange 2010: Poor Man’s Monitoring |</title><meta name=description content="Exchange 2010: Poor Man’s Monitoring - %!s(&lt;nil&gt;)"><meta itemprop=name content="Exchange 2010: Poor Man’s Monitoring"><meta itemprop=description content="Exchange 2010: Poor Man’s Monitoring - %!s(&lt;nil&gt;)"><meta property=og:title content="Exchange 2010: Poor Man’s Monitoring"><meta property=og:description content="Exchange 2010: Poor Man’s Monitoring - %!s(&lt;nil&gt;)"><meta property=og:image content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200"><meta property=og:url content=https://zacharyloeber.com/blog/2012/07/22/exchange-2010-poor-mans-monitoring/><meta property=og:site_name content><meta property=og:type content=article><link rel=icon type=image/png href=https://zacharyloeber.com/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=https://zacharyloeber.com/favicon-16x16.png sizes=16x16><link rel=stylesheet href=/sass/combined.min.5aca3dc995ccd40fd537c60ccb5ce5882145ec5d4c4827c15f277667981cc0de.css></head><body class=bilberry-hugo-theme><nav><div class=container><ul class=topnav><li><a href=https://github.com/zloeber target=_blank>Github</a></li><li><a href=/page/about/>About</a></li><li><a href=/page/about-me/>About Me</a></li></ul></div></nav><header><div class=container><div class=logo><a href=/ class=logo><img src="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?d=mm&size=200" alt>
<span class=overlay><i class="fa fa-home"></i></span></a></div><div class=titles><h3 class=title><a href=/>My cool new blog</a></h3></div><div class=toggler><i class="fa fa-bars" aria-hidden=true></i></div></div></header><div class="main container"><div class="article-wrapper u-cf single"><a class=bubble href=/blog/2012/07/22/exchange-2010-poor-mans-monitoring/><i class="fa fa-fw fa-pencil"></i></a><article class="default article"><div class=content><h3><a href=/blog/2012/07/22/exchange-2010-poor-mans-monitoring/>Exchange 2010: Poor Man’s Monitoring</a></h3><div class=meta><span class="date moment">2012-07-22</span>
<span class=categories><a href=/categories/exchange>Exchange</a>
<a href=/categories/exchange-2010>Exchange 2010</a>
<a href=/categories/microsoft>Microsoft</a>
<a href=/categories/powershell>Powershell</a>
<a href=/categories/storage>Storage</a>
<a href=/categories/system-administration>System Administration</a></span>
<span class=author><a href=/author/zachary-loeber>Zachary Loeber</a></span></div><p>I quietly released a new script into the wild the other day, Troubleshoot-MailboxServer.ps1. This script is meant for monitoring, fixing, and reporting on Exchange 2010 database servers. It pretty much just wraps around and reports on troubleshooting scripts found in %ExchangeInstallPath%Scripts. I also set it so you can have an email sent including warning/error color coded report upon completion.</p><p>Optionally, an overall system health overview can be sent following any warnings/errors which are generated from the scripts. This last report is purely optional and is actually just another person’s script which I rolled into Troubleshoot-MailboxServer.ps1. This report has some external requirements though. <a href=http://www.simple-talk.com/sysadmin/powershell/building-a-daily-systems-report-email-with-powershell/>The original author’s release of the script can be read here</a>. The external requirements are <a href="http://www.microsoft.com/download/en/details.aspx?id=14422">MS Chart Controls for .Net 3.5</a>. So if you are not wanting to install these requirements on your Exchange server then make certain to set $SendSystemReport to $false.</p><p>The scripts which Troubleshoot-MailboxServer.ps1 calls are as follows:</p><ul><li>Troubleshoot-CI.ps1 (I cannot seem to find the ms technet article for this one)</li><li><a href=http://technet.microsoft.com/en-us/library/ff798271>Troubleshoot-DatabaseLatency.ps1</a></li><li><a href=http://technet.microsoft.com/en-us/library/ff477617.aspx>Troubleshoot-DatabaseSpace.ps1</a></li></ul><p>More information about the <a href=http://blogs.technet.com/b/exchange/archive/2011/01/18/3411844.aspx>Exchange 2010 Troubleshooters can be found here.</a></p><p>For good measure I tossed in the option to redistribute your DAG(s) with <a href="http://technet.microsoft.com/library/dd335158%28v=EXCHG.141%29">RedistributeActiveDatabases.ps1</a>.</p><p>Be cautioned that, although this script does have a “testing” mode, it does not prevent the troubleshooter scripts from disabling provisioning of mailboxes to databases as that feature is not available as part of the troubleshooter scripts. Should you find that databases have become unprovisionable and you want the ability to provision to them again you need to run the following from an Exchange 2010 management shell:</p><pre>Set-MailboxDatabase &lt;database name&gt; -IsExcludedFromProvisioning:$false</pre><p>In Exchange 2010 SP1 the CheckDatabaseRedundancy.ps1 script is included and scheduled to automatically run. Apparently they used ManageScheduledTask.ps1 (which is also new to SP1) to automate scheduling the task. As when you use ManageScheduledTask.ps1 the description given to any new scheduled task you create with it reads that it is a task for checking database redundancy J. Regardless, you can use that script to schedule Exchange-DatabaseMonitoring.ps1.</p><pre>cd $exscripts</pre><pre>.\ManageScheduledTask.ps1 -Install -ServerName &lt;Your Server&gt; -PsScriptPath C:\Scripts\Troubleshoot-MailboxServer.ps1 -TaskName "Troubleshoot Exchange 2010 Mailbox Servers"</pre><p>(Note: this adds the scheduled task as a generic task, you will still need to go into scheduled tasks  and set a schedule for it to run and add change the description).</p><p>Download the script: <a href=/wp-content/uploads/2012/07/Troubleshoot-MailboxServer.ps1>Troubleshoot-MailboxServer.ps1</a></p><p>or</p><p class=MsoNoSpacing><a title="Troubleshoot-MailboxDatabase on Technet script center" href=http://gallery.technet.microsoft.com/scriptcenter/Troubleshoot-Exchange-2010-aecdc23f>From here</a></p></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=/tags/exchange-2010>Exchange 2010</a>
<a href=/tags/microsoft>Microsoft</a>
<a href=/tags/monitoring>Monitoring</a>
<a href=/tags/powershell>Powershell</a>
<a href=/tags/system-administration>System Administration</a></div></div></div></article></div><div id=disqus_thread></div><script type=application/javascript>var disqus_config=function(){};(function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById('disqus_thread').innerHTML='Disqus comments not available by default when the website is previewed locally.';return;}
var d=document,s=d.createElement('script');s.async=true;s.src='//'+"zacharyloeber-com"+'.disqus.com/embed.js';s.setAttribute('data-timestamp',+new Date());(d.head||d.body).appendChild(s);})();</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div><footer><div class=container><div class=recent-posts><strong>Latest posts</strong><ul><li><a href=/blog/2018/12/10/devops-tool-of-the-day-syncthing/>Devops: Tool of the day – Syncthing</a></li><li><a href=/blog/2018/09/28/devops-automating-kubernetes-deployments/>DevOps – Automating Kubernetes Deployments</a></li><li><a href=/blog/2018/05/02/powershell-to-python-notes-from-the-field/>Powershell To Python Notes From The Field</a></li><li><a href=/blog/2018/03/26/powershell-windows-subsystem-for-linux/>PowerShell: Windows Subsystem For Linux</a></li><li><a href=/blog/2018/02/24/email-reputation-and-design-a-condensed-guide/>Email Reputation and Design: A Condensed Guide</a></li><li><a href=/blog/2018/02/04/powershell-azuread-dynamic-groups/>PowerShell: AzureAD Dynamic Groups</a></li><li><a href=/blog/2018/01/10/powershell-office-365-group-based-licencing-cleanup/>PowerShell: Office 365 Group Based Licencing Cleanup</a></li></ul></div><div class=categories><a href=/categories/><strong>Categories</strong></a><ul><li><a href=/categories/system-administration>System administration (130)</a></li><li><a href=/categories/microsoft>Microsoft (120)</a></li><li><a href=/categories/powershell>Powershell (106)</a></li><li><a href=/categories/networking>Networking (52)</a></li><li><a href=/categories/active-directory>Active directory (44)</a></li><li><a href=/categories/exchange>Exchange (38)</a></li><li><a href=/categories/exchange-2010>Exchange 2010 (38)</a></li></ul></div><div class=right><div class=external-profiles><strong>Social media</strong></div></div></div></footer><div class=credits><div class=container><div class=copyright><a href=https://github.com/Lednerb target=_blank>&copy;
2018
by Lednerb</a></div><div class=author><a href=https://github.com/Lednerb/bilberry-hugo-theme target=_blank>Bilberry Hugo Theme</a></div></div></div><script type=text/javascript src=/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script><script type=text/javascript src=/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script><script>$(".moment").each(function(){$(this).text(moment($(this).text()).locale("en").format('LL'));});$(".footnote-return sup").html("");</script></body></html>