<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code">
        <meta name="generator" content="Hugo 0.53" />
        <title> Powershell: Colorize-Table Function | Zachary Loeber</title>
        <meta name="description" content="Powershell: Colorize-Table Function - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="Powershell: Colorize-Table Function">
        <meta itemprop="description" content="Powershell: Colorize-Table Function - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="Powershell: Colorize-Table Function">
        <meta property="og:description" content="Powershell: Colorize-Table Function - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="https://zacharyloeber.com/blog/2013/04/17/powershell-colorize-table-function/">
        <meta property="og:site_name" content="Zachary Loeber">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	

        
        
        
        
        <link rel="stylesheet" href="/sass/combined.min.5f50be91a665634f9dfed5900bc388393fc430e3369d58e73b8375457a6df832.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="https://zacharyloeber.com" target="">Home</a></li>
                
            
                
                    <li><a href="/page/about/">About</a></li>
                
            
                
                    <li><a href="/page/about-me/">About Me</a></li>
                
            
                
                    <li><a href="https://github.com/zloeber" target="_blank">Github</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Zachary Loeber</a></h3>
            
                <span class="subtitle">The personal website of Zachary Loeber.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="/blog/2013/04/17/powershell-colorize-table-function/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="/blog/2013/04/17/powershell-colorize-table-function/">Powershell: Colorize-Table Function</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2013-04-18</span>
            
        

        
            <span class="readingTime">3 min read</span>
        

        
            <span class="categories">
                
                    <a href="/categories/microsoft">Microsoft</a>
                
                    <a href="/categories/powershell">Powershell</a>
                
                    <a href="/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>Here is a function I modified for quickly modifying the attributes of a table&#8217;s rows or individual cells. It uses Linq and is blistering fast. The results are pretty as well so that doesn&#8217;t hurt either.</p>

<p><a href="http://gallery.technet.microsoft.com/Colorize-HTML-Table-Cells-2ea63acd" title="Powershell Colorize-Table Function on Technet gallery">Here is the script on the Technet Gallery</a></p>

<p>Here is an example which produces a semi-useful example report of the top memory consuming processes.  Anything taking over 150 Mb is highlighted yellow. Above 400 Mb gets highlighted red. The order for processing the table is obviously important, so they don’t all end up the same color. For this example we highlight the entire row but the individual cells can just as easily be color coded with this function (or styled or whatever fits your fancy actually).</p>

<p>By default the table is boring. This custom header is used to add some borders and such.</p>

<pre>$TableStyle = @'</pre>

<pre>&lt;title&gt;Process Report&lt;/title&gt;</pre>

<pre>      &lt;style&gt;</pre>

<pre>      BODY{font-family: Arial; font-size: 8pt;}</pre>

<pre>      H1{font-size: 16px;}</pre>

<pre>      H2{font-size: 14px;}</pre>

<pre>      H3{font-size: 12px;}</pre>

<pre>      TABLE{border: 1px solid black; border-collapse: collapse; font-size: 8pt;}</pre>

<pre>      TH{border: 1px solid black; background: #dddddd; padding: 5px; color: #000000;}</pre>

<pre>      TD{border: 1px solid black; padding: 5px;}</pre>

<pre>      &lt;/style&gt;</pre>

<pre>'@</pre>

<p>Now gather all processes, include the name, company, and Memory. Rename WS to Memory for readability, truncate, and convert to Mb. then sort in reverse order and return the top 5 results.</p>

<pre>$tabletocolorize = $(<b>get-process</b> | <b>select</b> <i>-Property</i> ProcessName,Company,@{Name="Memory";Expression={[math]::truncate($_.WS/ 1Mb)}} | <b>Sort-Object</b> Memory <i>-Descending</i> | <b>Select</b> <i>-First</i> 5 )</pre>

<p>This scriptblock is passed directly into the function, the variable names are important and should not change as they are used in the function (because I wasn’t able to get abstraction to work properly for whatever reason). If you really like you can replace [int]$args<a href="http://gallery.technet.microsoft.com/Colorize-HTML-Table-Cells-2ea63acd" title="Powershell Colorize-Table Function on Technet gallery">1</a> with some static number or string and the ColumnValue parameter will be ignored when passed to the function. I also found it was important to use strong typesetting in the script block. If you don’t need anything fancy and just want to change a cell/row based on what value is in it then don’t pass any scriptblock and a general equal comparison will be performed on ColumnValue which you will have to pass instead.</p>

<pre>[scriptblock]$scriptblock = {[int]$args[0] -gt [int]$args[1]}</pre>

<p>Run the first passthrough for any columns with the Memory value above 150 to highlight the row yellow. This is the first time through so I tack on the HTMLHead.</p>

<pre>$testreport = Colorize-Table $tabletocolorize <i>-Column</i> "Memory" <i>-ColumnValue</i> 150 <i>-Attr</i> "style" <i>-AttrValue</i> "background:yellow;" <i>-ScriptBlock</i> $ScriptBlock <i>-HTMLHead</i> $TableStyle <i>-WholeRow</i> $true</pre>

<p>Then run again for the same row for any items above 400 to highlight the row red.</p>

<pre>$testreport = Colorize-Table $testreport <i>-Column</i> "Memory" <i>-ColumnValue</i> 400 <i>-Attr</i> "style" <i>-AttrValue</i> "background:red;" <i>-ScriptBlock</i> $ScriptBlock <i>-WholeRow</i> $true</pre>

<p>Spit out the report to a file and open it up.</p>

<pre>$testreport | <b>Out-File</b> "$pwd/testreport.html"</pre>

<pre><b>ii</b> "$pwd/testreport.html"</pre>

<p>The resulting table</p>

<p><a href="/wp-content/uploads/2013/04/ColoredTable-Process_Report.jpg"><img class="aligncenter size-full wp-image-759" alt="ColoredTable-Process_Report" src="/wp-content/uploads/2013/04/ColoredTable-Process_Report.jpg?resize=249%2C143" width="249" height="143" data-recalc-dims="1" /></a></p>
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/network-administration">network administration</a>
                
                    <a href="/tags/powershell">Powershell</a>
                
                    <a href="/tags/reporting">Reporting</a>
                
                    <a href="/tags/scripting">Scripting</a>
                
                    <a href="/tags/system-administration">System Administration</a>
                
            </div>
        </div>
    

    
</div>

</article>

        
    </div>

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zacharyloeber-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="/blog/2018/12/10/devops-tool-of-the-day-syncthing/">Devops: Tool of the day – Syncthing</a>
                    </li>
                
                    <li>
                        <a href="/blog/2018/09/28/devops-automating-kubernetes-deployments/">DevOps – Automating Kubernetes Deployments</a>
                    </li>
                
                    <li>
                        <a href="/blog/2018/05/02/powershell-to-python-notes-from-the-field/">Powershell To Python Notes From The Field</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="/categories/networking">Networking (52)</a>
                    </li>
                
                    <li>
                        <a href="/categories/active-directory">Active directory (44)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2019
                
                by Zachary Loeber
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
