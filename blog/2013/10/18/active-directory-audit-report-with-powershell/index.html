<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code">
        <meta name="generator" content="Hugo 0.53" />
        <title> Active Directory Audit Report With Powershell | Zachary Loeber</title>
        <meta name="description" content="Active Directory Audit Report With Powershell - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="Active Directory Audit Report With Powershell">
        <meta itemprop="description" content="Active Directory Audit Report With Powershell - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="Active Directory Audit Report With Powershell">
        <meta property="og:description" content="Active Directory Audit Report With Powershell - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="https://zacharyloeber.com/blog/2013/10/18/active-directory-audit-report-with-powershell/">
        <meta property="og:site_name" content="Zachary Loeber">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	

        
        
        
        
        <link rel="stylesheet" href="https://zacharyloeber.com/sass/combined.min.5f50be91a665634f9dfed5900bc388393fc430e3369d58e73b8375457a6df832.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="https://zacharyloeber.com/" target="">Home</a></li>
                
            
                
                    <li><a href="https://zacharyloeber.com/page/about/">About</a></li>
                
            
                
                    <li><a href="https://zacharyloeber.com/page/about-me/">About Me</a></li>
                
            
                
                    <li><a href="https://github.com/zloeber" target="_blank">Github</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="https://zacharyloeber.com/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="https://zacharyloeber.com/">Zachary Loeber</a></h3>
            
                <span class="subtitle">The personal website of Zachary Loeber.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://zacharyloeber.com/blog/2013/10/18/active-directory-audit-report-with-powershell/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://zacharyloeber.com/blog/2013/10/18/active-directory-audit-report-with-powershell/">Active Directory Audit Report With Powershell</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2013-10-18</span>
            
        

        
            <span class="readingTime">3 min read</span>
        

        
            <span class="categories">
                
                    <a href="https://zacharyloeber.com/categories/active-directory">Active Directory</a>
                
                    <a href="https://zacharyloeber.com/categories/exchange">Exchange</a>
                
                    <a href="https://zacharyloeber.com/categories/exchange-2010">Exchange 2010</a>
                
                    <a href="https://zacharyloeber.com/categories/lync">Lync</a>
                
                    <a href="https://zacharyloeber.com/categories/microsoft">Microsoft</a>
                
                    <a href="https://zacharyloeber.com/categories/office-communicator-server">Office Communicator Server</a>
                
                    <a href="https://zacharyloeber.com/categories/powershell">Powershell</a>
                
                    <a href="https://zacharyloeber.com/categories/system-administration">System Administration</a>
                
            </span>
        

        
            <span class="author"><a href="https://zacharyloeber.com/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>Not too long ago I wrote a quick post on how easy it is to gather information from AD. As a case in point example I provided a script to gather all the disabled user accounts which are still assigned Lync IDs. In this script I take it one step further and provide a full blown Active Directory reporting script which can be produced with any non-privileged domain user account.</p>

<h3 id="features">Features</h3>

<p><span style="line-height: 1.6;">To create the output I repurposed my server asset reporting script. This means several output methods are baked right in.</span></p>

<ul>
<li><p>Report Containers/Types</p></li>

<li><p>Documentation – Currently the only format for this type of report. This returns all data gathered in the report.</p></li>

<li><p>HTML Templates</p>

<ul>
<li>DynamicGrid – A heavily modified CSS layout</li>
<li>EmailFriendly – A basic layout</li>
</ul></li>

<li><p>Saved Report Layout</p>

<ul>
<li><span style="text-decoration: line-through;">Individual – Each asset saves as its own file </span></li>
<li>One big report – Only a single report will be generated no matter which option you choose.</li>
</ul></li>

<li><p>Saved Report File Format</p>

<ul>
<li>HTML</li>
<li>PDF</li>
</ul></li>

<li><p>Email Reports (HTML only)</p></li>

<li><p>Export all data to individual worksheets within Excel</p></li>
</ul>

<p>Aside from the report, additionally three diagrams will be created which this script is run. One for domain trusts, another for site replication connections, and a third for site adjacencies. By default the diagram source text file and a png file will get created in the directory which you run the script.</p>

<p>To actually generate the diagrams you will need graphviz’s dot.exe executable which can be downloaded and installed <a href="http://graphviz.org/">here</a>. Or <a href="https://code.google.com/p/graph-viz-portable/downloads/list">here is a portable version</a> of the application you can try utilizing. All you need is for the dot.exe file to work correctly to generate your diagram. You may have to modify this script to use the appropriate path to the executable if you use the portable version of graphviz.</p>

<p>(If you don&#8217;t care about the diagrams either comment out the code or ignore the errors as it tries to run dot.exe)</p>

<h3 id="report-data">Report Data</h3>

<p>I’ve included only items which can be gathered from Active Directory with a regular user account and without any special AD modules. This is what has been added thus far:</p>

<ul>
<li>Forest Information

<ul>
<li>Forest Summary

<ul>
<li>Name/<span style="line-height: 1.6;">Functional Level</span></li>
<li><span style="line-height: 1.6;">Domain/Site/</span><span style="line-height: 1.6;">DC/GC/Exchange/Lync/Pool counts</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Forest Features</span>

<ul>
<li>Tombstone Lifetime</li>
<li><span style="line-height: 1.6;">Recycle Bin Enabled</span></li>
<li><span style="line-height: 1.6;">Lync AD Container</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Exchange Servers</span>

<ul>
<li><span style="line-height: 1.6;">Organization/Administrative Group/Name/Roles/Site</span></li>
<li><span style="line-height: 1.6;">Serial/Product ID</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Lync</span>

<ul>
<li><span style="line-height: 1.6;">Element (Server/Pool)</span></li>
<li><span style="line-height: 1.6;">Type (Internal/Edge/Backend/Pool)</span></li>
<li><span style="line-height: 1.6;">Name/FQDN</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Site Information</span>

<ul>
<li><span style="line-height: 1.6;">Summary</span>

<ul>
<li><span style="line-height: 1.6;">Site Name/Location/Domains/DCs/Subnets</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Details</span>

<ul>
<li><span style="line-height: 1.6;">Site Name/Options/ISTG/Links/Bridgeheads/Adjacencies</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Subnets</span>

<ul>
<li><span style="line-height: 1.6;">Subnet/Site Name/Location</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Site Connections</span>

<ul>
<li><span style="line-height: 1.6;">Enabled/Options/From/To</span></li>
</ul></li>
</ul></li>
<li><span style="line-height: 1.6;">Domain Information</span>

<ul>
<li><span style="line-height: 1.6;">Domains</span>

<ul>
<li><span style="line-height: 1.6;">Name/NetBIOS/Functional Level/Forest Root/Assigned FSMO Roles</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Domain Password Policies</span>

<ul>
<li><span style="line-height: 1.6;">Name/NetBIOS/Lockout Threshold/Pass History Length/Max Pass Age/Min Pass Age/Min Pass Length</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Domain Controllers</span>

<ul>
<li><span style="line-height: 1.6;">Domain/Site/Name/OS/Time/IP/GC/FSMO Roles</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Domain Trusts</span>

<ul>
<li><span style="line-height: 1.6;">Domain/Trusted Domain/Direction/Attributes/Trust Type/Created/Modified</span></li>
</ul></li>
<li><span style="line-height: 1.6;">Domain DFS Shares</span>

<ul>
<li><span style="line-height: 1.6;">Domain/Name/DN/Remote Server</span></li>
</ul></li>
</ul></li>
</ul></li>
</ul>

<h3 id="screenshots">Screenshots</h3>

<p>Here are some screenshots of the reports and diagrams which can be created:</p>

<p><a href="wp-content/uploads/2013/10/DCs-Screenshot.jpg"><img style="margin: 5px; display: inline; background-image: none;" title="DCs-Screenshot" alt="DCs-Screenshot" src="https://zacharyloeber.com/wp-content/uploads/2013/10/DCs-Screenshot_thumb.jpg?resize=555%2C257" width="555" height="257" border="0" data-recalc-dims="1" /></a></p>

<p><a href="wp-content/uploads/2013/10/domains-screenshot.jpg"><img style="margin: 5px; display: inline; background-image: none;" title="domains-screenshot" alt="domains-screenshot" src="https://zacharyloeber.com/wp-content/uploads/2013/10/domains-screenshot_thumb.jpg?resize=557%2C50" width="557" height="50" border="0" data-recalc-dims="1" /></a></p>

<p><a href="wp-content/uploads/2013/10/ForestSummary-screenshot.jpg"><img style="margin: 5px; display: inline; background-image: none;" title="ForestSummary-screenshot" alt="ForestSummary-screenshot" src="https://zacharyloeber.com/wp-content/uploads/2013/10/ForestSummary-screenshot_thumb.jpg?resize=428%2C154" width="428" height="154" border="0" data-recalc-dims="1" /></a></p>

<p><a href="wp-content/uploads/2013/10/Lync-sreenshot.jpg"><img style="margin: 5px; display: inline; background-image: none;" title="Lync-sreenshot" alt="Lync-sreenshot" src="https://zacharyloeber.com/wp-content/uploads/2013/10/Lync-sreenshot_thumb.jpg?resize=268%2C215" width="268" height="215" border="0" data-recalc-dims="1" /></a></p>

<p><a href="wp-content/uploads/2013/10/SiteConnections-screenshot.jpg"><img style="margin: 5px; display: inline; background-image: none;" title="SiteConnections-screenshot" alt="SiteConnections-screenshot" src="https://zacharyloeber.com/wp-content/uploads/2013/10/SiteConnections-screenshot_thumb.jpg?resize=267%2C164" width="267" height="164" border="0" data-recalc-dims="1" /></a></p>

<p><a href="https://zacharyloeber.com/wp-content/uploads/2013/10/SiteSubnets-screenshot.jpg"><img style="margin: 5px; display: inline; background-image: none;" title="SiteSubnets-screenshot" alt="SiteSubnets-screenshot" src="https://zacharyloeber.com/wp-content/uploads/2013/10/SiteSubnets-screenshot_thumb.jpg?resize=261%2C152" width="261" height="152" border="0" data-recalc-dims="1" /></a></p>

<p><a href="wp-content/uploads/2013/10/Trusts-screenshot.jpg"><img style="margin: 5px; display: inline; background-image: none;" title="Trusts-screenshot" alt="Trusts-screenshot" src="https://zacharyloeber.com/wp-content/uploads/2013/10/Trusts-screenshot_thumb.jpg?resize=359%2C106" width="359" height="106" border="0" data-recalc-dims="1" /></a></p>

<p><a href="https://zacharyloeber.com/wp-content/uploads/2013/10/trusts-screenshot2.jpg"><img style="margin: 5px; display: inline; background-image: none;" title="trusts-screenshot2" alt="trusts-screenshot2" src="https://zacharyloeber.com/wp-content/uploads/2013/10/trusts-screenshot2_thumb.jpg?resize=410%2C102" width="410" height="102" border="0" data-recalc-dims="1" /></a></p>

<h3 id="downloads">Downloads</h3>

<p><a href="http://gallery.technet.microsoft.com/Active-Directory-Audit-7754a877">You can download the script from the technet galleries.</a></p>
    
</div>

    
<div class="footer no-tags">


    

    
</div>

</article>

        
    </div>

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zacharyloeber-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="https://zacharyloeber.com/blog/2018/12/10/devops-tool-of-the-day-syncthing/">Devops: Tool of the day – Syncthing</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/blog/2018/09/28/devops-automating-kubernetes-deployments/">DevOps – Automating Kubernetes Deployments</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/blog/2018/05/02/powershell-to-python-notes-from-the-field/">Powershell To Python Notes From The Field</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="https://zacharyloeber.com/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/networking">Networking (52)</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/active-directory">Active directory (44)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2019
                
                by Zachary Loeber
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="https://zacharyloeber.com/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="https://zacharyloeber.com/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
