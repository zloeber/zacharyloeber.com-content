<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code">
        <meta name="generator" content="Hugo 0.53" />
        <title> Powershell Tip: Convert HTML to PDF | Zachary Loeber</title>
        <meta name="description" content="Powershell Tip: Convert HTML to PDF - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="Powershell Tip: Convert HTML to PDF">
        <meta itemprop="description" content="Powershell Tip: Convert HTML to PDF - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="Powershell Tip: Convert HTML to PDF">
        <meta property="og:description" content="Powershell Tip: Convert HTML to PDF - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="https://zacharyloeber.com/blog/2014/03/07/posh-tip-convert-html-to-pdf/">
        <meta property="og:site_name" content="Zachary Loeber">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="https://zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	

        
        
        
        
        <link rel="stylesheet" href="https://zacharyloeber.com/sass/combined.min.5f50be91a665634f9dfed5900bc388393fc430e3369d58e73b8375457a6df832.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="https://zacharyloeber.com/" target="">Home</a></li>
                
            
                
                    <li><a href="https://zacharyloeber.com/page/about/">About</a></li>
                
            
                
                    <li><a href="https://zacharyloeber.com/page/about-me/">About Me</a></li>
                
            
                
                    <li><a href="https://github.com/zloeber" target="_blank">Github</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="https://zacharyloeber.com/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="https://zacharyloeber.com/">Zachary Loeber</a></h3>
            
                <span class="subtitle">The personal website of Zachary Loeber.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="https://zacharyloeber.com/blog/2014/03/07/posh-tip-convert-html-to-pdf/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="https://zacharyloeber.com/blog/2014/03/07/posh-tip-convert-html-to-pdf/">Powershell Tip: Convert HTML to PDF</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2014-03-07</span>
            
        

        
            <span class="readingTime">4 min read</span>
        

        
            <span class="categories">
                
                    <a href="https://zacharyloeber.com/categories/microsoft">Microsoft</a>
                
                    <a href="https://zacharyloeber.com/categories/powershell">Powershell</a>
                
            </span>
        

        
            <span class="author"><a href="https://zacharyloeber.com/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>There are no native methods to create a pdf file in Powershell. So I looked into outside sources for converting HTML output to PDF. I ended up using a stand alone dll and some .NET calls to achieve my goal.</p>

<h3 id="introduction">Introduction</h3>

<p>Honestly I forgot why I thought it would be important that my report generation scripts be able to create pdf output. I had a fun time figuring out how to make it happen though. I settled on using <a href="http://pdfgenerator.codeplex.com/">a third party dll</a> from codeplex (supposedly codeplex.com is all about open source projects but I’ve yet to see the source for several of the cooler projects hosted here). While watching a movie with the wife I proceeded to work my way backwards from a VB example to come up with a Powershell alternative. This is how it works.</p>

<h3 id="details">Details</h3>

<p>Here is the singular example given for this dll:</p>

<blockquote>
<p>Generate PDF with one line of code:</p>

<pre>var pdfBytes = (new NReco.HtmlToPdfConverter()).GeneratePdf(htmlContent);</pre>
</blockquote>

<p>The code seems simple enough, feed the GeneratePdf object member some html and a pdf will get created like magic. The minor challenge is taking this .Net based dll, loading it into memory, defining the correct object from its assemblies, and feeding it the properly formatted html data so that it can create a pdf.</p>

<p>First lets define the dll location (which we test actually exists in a full blown function provided later):</p>

<pre>$PdfGenerator = "$((Get-Location).Path)\NReco.PdfGenerator.dll"</pre>

<p>Next lets load up the assembly and create a new NReco.HtmlToPdfConverter object to work with:</p>

<pre>$Assembly = [Reflection.Assembly]::LoadFrom($PdfGenerator)
 $PdfCreator = New-Object NReco.PdfGenerator.HtmlToPdfConverter</pre>

<p>Finally, use the GeneratePdf method to create a pdf which we then write to a file in byte mode (pdf output is not simple text after all)</p>

<pre>$ReportOutput = $PdfCreator.GeneratePdf([string]$HTML)
Add-Content -Value $ReportOutput -Encoding byte -Path $FileName</pre>

<p>You will notice that I explicitly cast the $html to a string. With the function I provide you will have to send the html data cast this way. I found that if I pulled in html content from a file it would result in an array of strings which the GeneratePdf method would treat individually. This would end up creating 100+ page pdf pages (a page for every element).</p>

<p>If you play around with $PdfCreator you will find that there are several methods included for changing page size and other document properties as well.</p>

<h3 id="the-code">The Code</h3>

<p>Here is the function I came up with to convert html to a pdf. Included at the end is a quick example. If you are going to use this code then you will likely have to unblock the dll after extracting it into the same directory as the script. Also, I had to run PowerGUI as admin otherwise I didn’t have enough permission to load the dll into memory. Enjoy!</p>

<pre class="lang:powershell decode:true">Function ConvertTo-PDF
{
    &lt;#
    .SYNOPSIS
        Converts HTML strings to pdf files.
    .DESCRIPTION
        Converts HTML strings to pdf files.
    .PARAMETER HTML
        HTML to convert to pdf format.
    .PARAMETER ReportName
        File name to create as a pdf.

    .EXAMPLE
        $html = 'test'
        try 
        {
            ConvertTo-PDF -HTML $html -FileName 'test.pdf' #-ErrorAction SilentlyContinue) 
            Write-Output 'HTML converted to PDF file test.pdf'
        } 
        catch
        {
            Write-Output 'Something bad happened! :('
        }

        Description:
        ------------------
        Create a pdf file with the content of 'test' if the pdf creation dll is available.

    .NOTES
        Requires   : NReco.PdfGenerator.dll (http://pdfgenerator.codeplex.com/)
        Version    : 1.0 03/07/2014
                     - Initial release
        Author     : Zachary Loeber

        Disclaimer : This script is provided AS IS without warranty of any kind. I 
                     disclaim all implied warranties including, without limitation,
                     any implied warranties of merchantability or of fitness for a 
                     particular purpose. The entire risk arising out of the use or
                     performance of the sample scripts and documentation remains
                     with you. In no event shall I be liable for any damages 
                     whatsoever (including, without limitation, damages for loss of 
                     business profits, business interruption, loss of business 
                     information, or other pecuniary loss) arising out of the use of or 
                     inability to use the script or documentation. 

        Copyright  : I believe in sharing knowledge, so this script and its use is 
                     subject to : http://creativecommons.org/licenses/by-sa/3.0/
    .LINK
        http://zacharyloeber.com/

    .LINK
        http://nl.linkedin.com/in/zloeber
    #&gt;
    [CmdletBinding()]
    param
    (
        [Parameter( HelpMessage="Report body, in HTML format.", 
                    ValueFromPipeline=$true )]
        [string]
        $HTML,
        [Parameter( HelpMessage="Report filename to create." )]
        [string]
        $FileName
    )
    BEGIN
    {
        $DllLoaded = $false
        $PdfGenerator = "$((Get-Location).Path)\NReco.PdfGenerator.dll"
        if (Test-Path $PdfGenerator)
        {
            try
            {
                $Assembly = [Reflection.Assembly]::LoadFrom($PdfGenerator)
                $PdfCreator = New-Object NReco.PdfGenerator.HtmlToPdfConverter
                $DllLoaded = $true
            }
            catch
            {
                Write-Error ('ConvertTo-PDF: Issue loading or using NReco.PdfGenerator.dll: {0}' -f $_.Exception.Message)
            }
        }
        else
        {
            Write-Error ('ConvertTo-PDF: NReco.PdfGenerator.dll was not found.')
        }
    }
    PROCESS
    {
        if ($DllLoaded)
        {
            $ReportOutput = $PdfCreator.GeneratePdf([string]$HTML)
            Add-Content -Value $ReportOutput -Encoding byte -Path $FileName
        }
        else
        {
            Throw 'Error Occurred'
        }
    }
    END
    {}
}

$html = 'test'
try 
{
    ConvertTo-PDF -HTML $html -FileName 'test.pdf' #-ErrorAction SilentlyContinue) 
    Write-Output 'HTML converted to PDF file test.pdf'
} 
catch
{
    Write-Output 'Something bad happened! :('
}</pre>
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="https://zacharyloeber.com/tags/powershell">Powershell</a>
                
                    <a href="https://zacharyloeber.com/tags/psc">PSC</a>
                
                    <a href="https://zacharyloeber.com/tags/scripting">Scripting</a>
                
            </div>
        </div>
    

    
</div>

</article>

        
    </div>

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zacharyloeber-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="https://zacharyloeber.com/blog/2018/12/10/devops-tool-of-the-day-syncthing/">Devops: Tool of the day – Syncthing</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/blog/2018/09/28/devops-automating-kubernetes-deployments/">DevOps – Automating Kubernetes Deployments</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/blog/2018/05/02/powershell-to-python-notes-from-the-field/">Powershell To Python Notes From The Field</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="https://zacharyloeber.com/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/networking">Networking (52)</a>
                    </li>
                
                    <li>
                        <a href="https://zacharyloeber.com/categories/active-directory">Active directory (44)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2019
                
                by Zachary Loeber
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="https://zacharyloeber.com/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="https://zacharyloeber.com/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
