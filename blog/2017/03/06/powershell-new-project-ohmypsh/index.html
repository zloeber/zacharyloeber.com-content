<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="author" content="Zachary Loeber">
        <meta name="description" content="Zachary Loeber&#39;s Personal Site">
        <meta name="keywords" content="blog,personal,devops,infrastructure,code">
        <meta name="generator" content="Hugo 0.53" />
        <title> PowerShell: New Project – OhMyPsh | Zachary Loeber</title>
        <meta name="description" content="PowerShell: New Project – OhMyPsh - Zachary Loeber&#39;s Personal Site">
        <meta itemprop="name" content="PowerShell: New Project – OhMyPsh">
        <meta itemprop="description" content="PowerShell: New Project – OhMyPsh - Zachary Loeber&#39;s Personal Site">
        <meta property="og:title" content="PowerShell: New Project – OhMyPsh">
        <meta property="og:description" content="PowerShell: New Project – OhMyPsh - Zachary Loeber&#39;s Personal Site">
        <meta property="og:image" content="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?size=200">
        <meta property="og:url" content="http://zacharyloeber.com/blog/2017/03/06/powershell-new-project-ohmypsh/">
        <meta property="og:site_name" content="Zachary Loeber">
        <meta property="og:type" content="article">
        <link rel="icon" type="image/png" href="http://zacharyloeber.com/favicon-32x32.png" sizes="32x32">
        <link rel="icon" type="image/png" href="http://zacharyloeber.com/favicon-16x16.png" sizes="16x16">

	

        
        
        
        
        <link rel="stylesheet" href="/sass/combined.min.5aca3dc995ccd40fd537c60ccb5ce5882145ec5d4c4827c15f277667981cc0de.css">

        

        
            
        
    </head>
    <body class="bilberry-hugo-theme">
        
<nav class="permanentTopNav">

    <div class="container">
        <ul class="topnav">
            
                
                    <li><a href="https://github.com/zloeber" target="_blank">Github</a></li>
                
            
                
                    <li><a href="/page/about/">About</a></li>
                
            
                
                    <li><a href="/page/about-me/">About Me</a></li>
                
            
        </ul>

        
    </div>
</nav>


        <header>
    <div class="container">
        <div class="logo">
            <a href="/" class="logo">
                
                    <img src="https://www.gravatar.com/avatar/48fc6231ab6cad25f101a82e5932d9dd?d=mm&size=200" alt="">
                

                <span class="overlay"><i class="fa fa-home"></i></span>
            </a>
        </div>
        <div class="titles">
            <h3 class="title"><a href="/">Zachary Loeber</a></h3>
            
                <span class="subtitle">The personal website of Zachary Loeber.</span>
            
        </div>

    

        
        <div class="toggler permanentTopNav">
        
            <i class="fa fa-bars" aria-hidden="true"></i>
        </div>
    </div>
</header>


        <div class="main container">
            
     
    <div class="article-wrapper u-cf single">
        
            <a class="bubble" href="/blog/2017/03/06/powershell-new-project-ohmypsh/">
    <i class="fa fa-fw fa-pencil"></i>
</a>

<article class="default article">
    

    <div class="content">
    <h3><a href="/blog/2017/03/06/powershell-new-project-ohmypsh/">PowerShell: New Project – OhMyPsh</a></h3>
    <div class="meta">
        
            
                <span class="date moment">2017-03-07</span>
            
        

        
            <span class="readingTime">4 min read</span>
        

        
            <span class="categories">
                
                    <a href="/categories/microsoft">Microsoft</a>
                
                    <a href="/categories/powershell">Powershell</a>
                
            </span>
        

        
            <span class="author"><a href="/author/zachary-loeber">Zachary Loeber</a></span>
        
    </div>

    
        <p>A PowerShell 5.0 terminal experience with lots of smart features that make you look cool at the command line.</p>

<p>Ok, so the ‘zinger’ line at the beginning of this post sounds like a sales pitch for a motorcycle or something but it is an apt description given the amount of features I’ve baked into this module. Here is probably a more accurate description:</p>

<blockquote>
<p>OhMyPsh is a personal profile management and profile loading wizard for PowerShell 5.0 (and greater) users that uses a simple json configuration file to manage plugins, themes, module auto-loading, module upgrading, module cleanup, and other chores so that you can be more productive in the shell.</p>
</blockquote>

<p>Before I go over what this module does, lets get a short background of why I went off the deep end and coded this project shall we?</p>

<h2 id="background">Background</h2>

<p>This project started with a simple need to be able to quickly use one off scripts without the need to put them in my profile or dot source them. I also wanted to be able to distribute scripts to my team without having to give instructions for how to get them to work or worry too much about prerequisite modules and other nonsense. Finally, I wanted to be able to quickly replicate my console experience between systems, automate module upgrades, and just make my PowerShell experience smarter in general.</p>

<p>In looking for already created solutions for this kind of thing I first looked at <a href="https://github.com/zloeber/PowerShellProfile">a highly customized powershell profile</a>. But this setup suffers from several drawbacks, most notably that you have to maintain the profile itself. It is also not easy to add/remove features without a bunch of manual effort and it is certainly not portable.</p>

<p>I found a few other projects that have the same name but are totally different incarnations of the same concept. These are as follows:</p>

<p><a href="https://github.com/pecigonzalo/Oh-My-Posh">Oh-My-Posh (pecigonzalo)</a> &#8211; Powershell amazingness inspired on Oh-My-Zsh, pshazz, fish. This provides a repository for PowerShell Customizations.</p>

<p><a href="https://github.com/JanJoris/oh-my-posh">Oh-My-Posh (JanJoris)</a> &#8211; A prompt theming engine for Powershell running in ConEmu</p>

<p>The first oh-my-posh listed above was more heavily structured around the original oh-my-zsh. It includes plugins and other such fun but I found that the code structure didn’t quite suit my needs. Besides, a zsh structured shell doesn’t necessarily carry over well to a Windows or Powershell based system. Regardless, I can honestly say that this was the module that inspired this project.</p>

<p>The second listed oh-my-posh above had some great ideas around theming and I really like it as well. It didn’t have any other real features though. It is also Conemu based with many of the theme prompts reliant upon the author’s favorite fonts.</p>

<p>Another module worth mentioning is <a href="https://github.com/Davlind/PSColor">PSColor</a>. If you want to ‘theme’ your console it involves intercepting the ‘out-default’ function which is generally called at the end of every baked in cmdlet in PowerShell. I initially was going to make PSColor a required module but there was a fatal flaw in its implementation that broke the out-default function upon unloading the module. I fixed this issue and submitted a pull request for the project but it hasn’t been merged as of yet. I decided simply to simply absorb the functionality of this module into oh-my-psh as that solves several issues for me and ensures that theming always works with my module the way it is intended to.</p>

<p>That all being said, I started building my own version of oh-my-psh and went totally off the deep end. Lets talk features shall we?</p>

<h2 id="features">Features</h2>

<p>OhMyPsh includes several appealing features for the PowerShell user. This included (but is not limited to):</p>

<ul>
<li>Automatic module updating (Via psget)</li>
<li>Automatic old module cleaning (Via psget)</li>
<li>Easy to add, load, and unload plugins</li>
<li>Theming (psreadline)</li>
<li>Persistent custom profile settings.</li>
<li>Integrated PSColor output (that can safely be unloaded)</li>
</ul>

<h2 id="installation">Installation</h2>

<p>Simple, this a PowerShell 5.0 based module that can be installed with a single command:</p>

<pre class="lang:powershell decode:true">install-module ohmypsh -scope:currentuser</pre>

<h2 id="use">Use</h2>

<p>Again, simple stuff:</p>

<pre class="lang:powershell decode:true">import-module ohmypsh</pre>

<p>But when you import the module nothing will change. That&#8217;s cool, lets spruce things up a little.</p>

<pre class="lang:powershell decode:true">Add-OMPPlugin psreadline
Add-OMPPlugin pscolor
Add-OMPPlugin banner
Add-OMPPlugin psdefaultparams
Add-OMPPlugin qod
Add-OMPPlugin fzf
Add-OMPPlugin powerline
Add-OMPPlugin psgit
Add-OMPPlugin moduleupgrade
Add-OMPPlugin moduleclean
Set-OMPTheme powerline</pre>

<p>This particular setup includes a theme that works very well with Conemu (which my favorite console app, cmder, wraps nicely around). If you are just using a plain powershell prompt then you may want to give either the jaykul or golagola themes a whirl instead.</p>

<h2 id="related-projects-credits">Related Projects/Credits</h2>

<p>This project is <a href="https://github.com/zloeber/OhMyPsh">hosted on github</a> and I welcome pull requests.</p>

<p>Here are some of the other references project sites, you should check &#8217;em out too.</p>

<p>[PSColor](<a href="https://github.com/Davlind/PSColor">https://github.com/Davlind/PSColor)</a></p>

<p>[PSReadline](<a href="https://msdn.microsoft.com/en-us/powershell/reference/5.1/psreadline/psreadline">https://msdn.microsoft.com/en-us/powershell/reference/5.1/psreadline/psreadline)</a></p>

<p>[Oh-My-Posh (pecigonzalo)](<a href="https://github.com/pecigonzalo/Oh-My-Posh)">https://github.com/pecigonzalo/Oh-My-Posh)</a></p>

<p>[Oh-My-Posh (JanJoris)](<a href="https://github.com/JanJoris/oh-my-posh">https://github.com/JanJoris/oh-my-posh</a>)</p>
    
</div>

    
<div class="footer">


    
        <div class="tags">
            <i class="fa fa-tags"></i>
            <div class="links">
                
                    <a href="/tags/powershell">Powershell</a>
                
                    <a href="/tags/scripting">Scripting</a>
                
                    <a href="/tags/windows">Windows</a>
                
            </div>
        </div>
    

    
</div>

</article>

        
    </div>

    
        <div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "zacharyloeber-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    

     

        </div>

        
<footer>
    <div class="container">

        
        <div class="recent-posts">
            <strong>Latest posts</strong>
                <ul>
                
                    <li>
                        <a href="/blog/2018/12/10/devops-tool-of-the-day-syncthing/">Devops: Tool of the day – Syncthing</a>
                    </li>
                
                    <li>
                        <a href="/blog/2018/09/28/devops-automating-kubernetes-deployments/">DevOps – Automating Kubernetes Deployments</a>
                    </li>
                
                    <li>
                        <a href="/blog/2018/05/02/powershell-to-python-notes-from-the-field/">Powershell To Python Notes From The Field</a>
                    </li>
                
                </ul>
        </div>
        

        
        <div class="categories">
            <a href="/categories/"><strong>Categories</strong></a>
                <ul>
                
                    <li>
                        <a href="/categories/system-administration">System administration (130)</a>
                    </li>
                
                    <li>
                        <a href="/categories/microsoft">Microsoft (120)</a>
                    </li>
                
                    <li>
                        <a href="/categories/powershell">Powershell (106)</a>
                    </li>
                
                    <li>
                        <a href="/categories/networking">Networking (52)</a>
                    </li>
                
                    <li>
                        <a href="/categories/active-directory">Active directory (44)</a>
                    </li>
                
            </ul>
        </div>
        

        <div class="right">
            
            <div class="external-profiles">
                <strong>Social media</strong>

                
                
                    <a href="https://twitter.com/zloeber" target="_blank"><i class="fa fa-twitter-adblock-proof"></i></a>
                
                
                
                
                
                
                
                
                
                    <a href="https://github.com/zloeber" target="_blank"><i class="fa fa-github"></i></a>
                
                
            </div>
            

            
        </div>
    </div>
</footer>


<div class="credits">
    <div class="container">
        <div class="copyright">
            <a href="https://github.com/zloeber" target="_blank">
                &copy;
                
                    2019
                
                by Zachary Loeber
            </a>
	    
        </div>
        <div class="author">
            <a href="https://github.com/Lednerb/bilberry-hugo-theme" target="_blank">Bilberry Hugo Theme</a>
        </div>
    </div>
</div>


        

        

        
        
        <script type="text/javascript" src="/js/externalDependencies.39c47e10e241eae2947b3fe21809c572.js" integrity="md5-OcR&#43;EOJB6uKUez/iGAnFcg=="></script>

        
        
        <script type="text/javascript" src="/js/theme.ff50ae6dc1bfc220b23bf69dbb41b54e.js" integrity="md5-/1CubcG/wiCyO/adu0G1Tg=="></script>

        <script>
            $(".moment").each(function() {
                $(this).text(
                    moment( $(this).text() )
                        .locale( "en" )
                        .format('LL')
                );
            });

            $(".footnote-return sup").html("");
        </script>

        
            
        

        


    </body>
</html>
